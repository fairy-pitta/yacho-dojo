# 野鳥識別士試験 勉強サイト 実装タスク

## Phase 1: 基本機能（MVP）

### 1.1 プロジェクトセットアップ
- [ ] Supabase認証付きNext.jsスターターキット使用 <mcreference link="https://vercel.com/templates/authentication/supabase" index="1">1</mcreference>
  - [ ] 現在のディレクトリに直接作成: `npx create-next-app --example with-supabase .`
  - [ ] または `yarn create next-app --example with-supabase .`
  - [ ] 既存ファイルとの競合確認・解決
  - [ ] スターターキットの特徴確認:
    - Next.js App Router対応
    - TypeScript + Tailwind CSS設定済み
    - shadcn/ui コンポーネント
    - Cookieベース認証
    - Supabase SSR設定済み
- [ ] 追加依存関係のインストール
  - [ ] グラフライブラリ（Chart.js, Recharts等）
  - [ ] UI拡張ライブラリ（必要に応じて）
- [ ] フォルダ構成の確認・拡張
  - [ ] components/ (既存)
  - [ ] app/ (App Router、既存)
  - [ ] lib/ (既存)
  - [ ] types/ (新規作成)
  - [ ] utils/ (新規作成)

### 1.2 Supabase セットアップ
- [ ] Supabase プロジェクト作成 <mcreference link="https://supabase.com/docs/guides/getting-started/quickstarts/nextjs" index="4">4</mcreference>
  - [ ] dashboard.supabase.com でプロジェクト作成
  - [ ] プロジェクト名: yacho-dojo
  - [ ] リージョン選択（Asia Pacific推奨）
- [ ] 環境変数設定
  - [ ] `.env.example` を `.env.local` にリネーム
  - [ ] プロジェクトのAPI設定から以下を取得・設定:
    - `NEXT_PUBLIC_SUPABASE_URL`
    - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- [ ] スターターキットの認証機能確認・テスト
  - [ ] 開発サーバー起動: `npm run dev`
  - [ ] 認証フロー動作確認
- [ ] カスタムデータベーステーブル作成
  - [ ] Users（auth.usersを使用、プロフィール拡張用）
  - [ ] Birds テーブル
  - [ ] BirdImages テーブル
  - [ ] Questions テーブル
  - [ ] UserAnswers テーブル
  - [ ] Comments テーブル
  - [ ] QuestionRatings テーブル
  - [ ] CommentRatings テーブル
- [ ] RLS（Row Level Security）ポリシー設定
- [ ] 外部キー制約設定

### 1.3 認証システム（スターターキット活用）
- [ ] 既存認証機能の確認・カスタマイズ <mcreference link="https://supabase.com/docs/guides/auth/server-side/nextjs" index="2">2</mcreference>
  - [ ] ログイン/サインアップページの確認（/login, /signup）
  - [ ] 認証フローの動作確認
  - [ ] ミドルウェア設定の確認（middleware.ts）
  - [ ] Server-Side Auth設定の確認
  - [ ] Cookieベース認証の動作確認
- [ ] Google OAuth プロバイダー追加設定
  - [ ] Supabase Auth設定でGoogle Provider有効化
  - [ ] Google Cloud Console設定
  - [ ] 認証フロー確認
- [ ] ユーザープロフィール管理の拡張
  - [ ] プロフィール編集ページ作成
  - [ ] アバター画像アップロード機能
  - [ ] プロフィール情報の追加フィールド
- [ ] 保護されたルートの追加設定
  - [ ] クイズページの保護
  - [ ] 成績ページの保護

### 1.4 基本UI コンポーネント
- [ ] レイアウトコンポーネント
  - [ ] Header（ナビゲーション、ユーザーメニュー）
  - [ ] Footer
  - [ ] Sidebar（メニュー）
- [ ] 共通UIコンポーネント
  - [ ] Button
  - [ ] Input
  - [ ] Modal
  - [ ] Loading Spinner
  - [ ] Toast 通知

### 1.5 ホーム画面
- [ ] ダッシュボードレイアウト
- [ ] 学習メニュー表示
- [ ] 成績サマリー表示（簡易版）
- [ ] クイズ開始ボタン

### 1.6 基本クイズシステム
- [ ] 問題データの取得API
  - [ ] ランダム問題取得
  - [ ] 問題詳細取得
- [ ] クイズ画面UI
  - [ ] 画像表示コンポーネント
  - [ ] 回答入力フィールド
  - [ ] 制限時間表示（オプション）
  - [ ] 進捗表示
- [ ] 回答判定ロジック
  - [ ] 正解判定（完全一致）
  - [ ] 部分一致対応
  - [ ] 表記ゆれ対応
- [ ] 結果画面
  - [ ] 正解/不正解表示
  - [ ] 正解の表示
  - [ ] 次の問題へのナビゲーション

### 1.7 回答履歴の記録
- [ ] UserAnswers テーブルへの保存
- [ ] 回答統計の計算
- [ ] 簡単な成績表示

## Phase 2: 学習支援機能

### 2.1 復習システム
- [ ] 間違えた問題の抽出ロジック
- [ ] 復習専用クイズモード
- [ ] 正解率による優先度付け
- [ ] 復習画面UI
  - [ ] 間違えた問題一覧
  - [ ] フィルタリング機能

### 2.2 詳細な成績分析
- [ ] 成績画面の拡張
  - [ ] 正解率推移グラフ
  - [ ] 分野別成績分析
  - [ ] 学習時間記録
  - [ ] 難易度別成績
- [ ] 統計データの計算API
- [ ] グラフ表示ライブラリの導入

### 2.3 問題絞り込み機能
- [ ] 設定画面の実装
  - [ ] 出題範囲選択（科・属別）
  - [ ] 難易度設定
  - [ ] 問題数設定
- [ ] フィルタリングロジック
- [ ] カスタム試験生成機能

### 2.4 画像最適化
- [ ] 画像の遅延読み込み
- [ ] レスポンシブ画像対応
- [ ] 画像キャッシュ戦略

## Phase 3: コミュニティ機能

### 3.1 コメント機能
- [ ] コメント投稿UI
  - [ ] 問題別コメント表示
  - [ ] コメント投稿フォーム
  - [ ] コメント編集・削除
- [ ] コメント管理API
  - [ ] 投稿・取得・更新・削除
  - [ ] ページネーション
- [ ] 返信機能
  - [ ] ネストしたコメント表示
  - [ ] 返信投稿機能

### 3.2 評価機能
- [ ] 問題評価システム
  - [ ] いいね・だめだねボタン
  - [ ] 評価の集計・表示
  - [ ] 重複評価の防止
- [ ] コメント評価システム
  - [ ] コメントへのいいね・だめだね
  - [ ] 評価数の表示

### 3.3 ユーザー間交流
- [ ] ユーザープロフィール拡張
  - [ ] 学習統計の公開設定
  - [ ] アバター設定
- [ ] ランキング機能
  - [ ] 正解率ランキング
  - [ ] 学習時間ランキング
  - [ ] 月間・週間ランキング

## Phase 4: 拡張機能（将来実装）

### 4.1 掲示板機能
- [ ] 掲示板システム設計
- [ ] トピック作成・管理
- [ ] カテゴリ分類
- [ ] モデレーション機能

### 4.2 プレミアム機能
- [ ] 課金システム設計
- [ ] Stripe 連携
- [ ] プレミアム限定機能
  - [ ] 詳細統計
  - [ ] 高画質画像
  - [ ] 優先サポート

### 4.3 PWA対応
- [ ] Service Worker 実装
- [ ] オフライン対応
- [ ] プッシュ通知
- [ ] アプリインストール対応

### 4.4 管理機能
- [ ] 管理者ダッシュボード
- [ ] 問題・画像管理
- [ ] ユーザー管理
- [ ] 統計・分析機能

## データ準備タスク

### データ収集・整理
- [ ] 野鳥リストの作成
- [ ] 画像収集（iNaturalist, Wikipedia等）
- [ ] ライセンス確認・記録
- [ ] 画像の品質チェック
- [ ] データベースへの投入
- [ ] 初期問題セットの作成

## テスト・品質保証

### テスト実装
- [ ] 単体テスト（Jest）
- [ ] 統合テスト
- [ ] E2Eテスト（Playwright）
- [ ] パフォーマンステスト

### 品質保証
- [ ] コードレビュー体制
- [ ] CI/CD パイプライン
- [ ] セキュリティ監査
- [ ] アクセシビリティ対応

## デプロイ・運用

### デプロイメント
- [ ] Vercel デプロイ設定
- [ ] 環境変数設定
- [ ] ドメイン設定
- [ ] SSL証明書設定

### 監視・運用
- [ ] エラー監視（Sentry）
- [ ] パフォーマンス監視
- [ ] ログ管理
- [ ] バックアップ戦略

## 実装優先度

### 最優先（Phase 1）
1. プロジェクトセットアップ
2. Supabase セットアップ
3. 認証システム
4. 基本クイズシステム
5. 回答履歴記録

### 高優先（Phase 2）
1. 復習システム
2. 詳細成績分析
3. 問題絞り込み機能

### 中優先（Phase 3）
1. コメント機能
2. 評価機能
3. ランキング機能

### 低優先（Phase 4）
1. 掲示板機能
2. プレミアム機能
3. PWA対応

## 注意事項

- 各フェーズの完了後に動作確認とテストを実施
- データベース設計の変更は早期に実施
- セキュリティ対策は各フェーズで継続的に実装
- ユーザビリティテストを定期的に実施
- パフォーマンス最適化は継続的に実施